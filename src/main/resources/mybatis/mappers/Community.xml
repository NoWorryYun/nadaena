<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Community">

	<!-- 커뮤니티 리스트 불러오기 -->
	<select id="comuList" parameterType="BoardVo" resultType="BoardVo">
		<![CDATA[
			select  rn,
			        ort.userNo,
			        ort.nickName,
			        ort.boardNo,
			        ort.challengeNo,
			        ort.clgTitle,
			        ort.category,
			        ort.title,
			        ort.boardContent,
			        ort.hit,
			        ort.boardDate,
			        boardDate2
			from(select rownum rn,
			            ot.userNo,
			            ot.nickName,
			            ot.boardNo,
			            ot.challengeNo,
			            ot.clgTitle,
			            ot.category,
			            ot.title,
			            ot.boardContent,
			            ot.hit,
			            ot.boardDate boardDate,
			            boardDate2
			    from (select    u.userNo userNo,
			                    u.nickName,
			                    b.boardNo boardNo,
			                    c.challengeNo challengeNo,
			                    c.clgTitle clgTitle,
			                    b.category category,
			                    b.title title,
			                    b.content boardContent,
			                    b.hit hit,
			                    b.boardDate boardDate,
			                    to_char(boardDate,'YYYY-MM-DD') boardDate2
			         from users u, challenge c, board b
			         where u.userNo = b.userNo
			         and c.challengeNo = b.challengeNo
			         
		]]>	
				
				
				<if test="keyword != ''  and  keyword != null ">
					and c.clgTitle like '%'||#{keyword}||'%'
				</if>
				
				<if test="category gt 0 ">
					and b.category = #{category}
				</if>
		
		
		
		<![CDATA[
			         
			         
			         
			         
			     order by boardNo desc) ot
			    )ort
			where ort.rn >=1
			and ort.rn <=10
			
		]]>
	</select>




	<select id="comentList" resultType="BoardVo">
		<![CDATA[
			select  rn,
			        ort.userNo,
			        ort.nickName,
			        ort.boardNo,
			        ort.challengeNo,
			        ort.clgTitle,
			        ort.category,
			        ort.title,
			        ort.boardContent,
			        ort.hit,
			        ort.boardDate,
			        ort.commentNo,
			        ort.commentDate,
			        ort.comments
			from (select rownum rn,
			             ot.userNo,
			             ot.nickName,
			             ot.boardNo,
			             ot.challengeNo,
			             ot.clgTitle,
			             ot.category,
			             ot.title,
			             ot.boardContent,
			             ot.hit,
			             ot.boardDate,
			             ot.commentNo,
			             ot.commentDate,
			             ot.comments
			    from(select u.userNo userNo,
			    			u.nickName nickName,
			                b.boardNo boardNo,
			                c.challengeNo challengeNo,
			                c.clgTitle clgTitle,
			                b.category category,
			                b.title title,
			                b.content boardContent,
			                b.hit hit,
			                b.boardDate boardDate,
			                cm.commentNo commentNo,
			                cm.commentDate commentDate,
			                cm.comments comments
			        from users u, challenge c, board b, comments cm
			        where u.userNo = b.userNo
			        and c.challengeNo = b.challengeNo
			        and cm.boardNo = b.boardNo
			        order by commentNo desc) ot
			    )ort
			where ort.rn >=1
			and ort.rn <=10
		
		]]>
	</select>








</mapper>